{% import "bootstrap/macros/page-boxes.html" as page_boxes %}
{% set posts = util.filtered(database.pages.values(), None, "post") %}

<div class="position-sticky" style="top: 2rem;">
	{# ABOUT #}
	<div class="p-4 mb-3 bg-body-tertiary rounded">
		<h4 class="fst-italic">About</h4>
		<p class="mb-0">
			{{ identity.about }}
		</p>
	</div>

	{# RECENT POSTS #}
	<a href="/posts/" class="icon-link gap-1 icon-link-hover text-decoration-none link-body-emphasis pt-2">
		<h4 class="fst-italic">
			Latest posts
			<i class="bi bi-chevron-right float-right"></i>
		</h4>
	</a>
	{% for item in posts[0:3] %}
	<div class="border-top">
		{{ page_boxes.simple(item, util) }}
	</div>
	{% endfor %}
	<a href="/posts/" class="icon-link gap-1 icon-link-hover pb-3 pt-2 border-top w-100">
		See more
		<i class="bi bi-chevron-right"></i>
	</a>

	{# TAG CLOUD #}
	<div class="pt-2 tag-cloud">
		<h4 class="fst-italic border-bottom pb-2">Popular tags</h4>
		<ol class="list-unstyled d-flex flex-wrap align-items-center justify-content-center">
			{% for tag, count in util.group_by_tag(posts, 15) %}
			<li>
				<a class="text-decoration-hover" href="/posts/?tag={{ tag }}" style="--size: {{ count }};">{{ tag }}</a>
			</li>
			{% endfor %}
		</ol>
	</div>

	{# BROWSE POSTS #}
	<div class="pt-2">
		<h4 class="fst-italic border-bottom pb-2">Browse posts</h4>
		<ol class="list-unstyled">
			{% for date, count in util.group_by_month(posts)[0:15] %}
			<li>
				<a href="/posts/?year={{ date.year }}&month={{ date.month }}">{{ util.monthfmt(date) }}</a>
				({{ count }})
			</li>
			{% endfor %}
		</ol>
	</div>

	{# BROWSE CATEGORIES #}
	<div class="pt-2">
		<h4 class="fst-italic border-bottom pb-2">Browse categories</h4>
		<ol class="list-unstyled">
			{% for category, count in util.group_by_category(posts) %}
			<li>
				<a href="/posts/?category={{ category }}">{{ category }}</a>
				({{ count }})
			</li>
			{% endfor %}
		</ol>
	</div>
</div>
